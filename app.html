<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>배움로그</title>
    <link rel="icon" type="image/png" href="images/Gemini_Generated_Image_d19ctrd19ctrd19c.png">
    <link rel="apple-touch-icon" href="images/Gemini_Generated_Image_d19ctrd19ctrd19c.png">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <link rel="stylesheet" href="style.css?v=20260217-1">
    <link rel="stylesheet" href="style_theme.css?v=20260217-1">
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;500;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="card">
        <!-- 로딩 화면 -->
        <div id="authLoadingSection" class="auth-loading-wrap">
            <div class="spinner auth-loading-spinner">
            </div>
            <p class="auth-loading-text">로그인 확인 중...</p>
        </div>

        <!-- 학생 온보딩 (첫 사용자) -->
        <div id="studentOnboardingSection" class="hidden">
            <h1 class="app-title">
                <img class="floating-emoji app-brand-icon" src="images/Gemini_Generated_Image_d19ctrd19ctrd19c-removebg-preview.png" alt="배움로그 아이콘">
                <span class="app-title-text">배움로그</span>
            </h1>
            <div class="top-action-row-end">
                <button onclick="logoutGoogle()"
                    class="btn-logout-compact">로그아웃</button>
            </div>
            <div class="accent-box box-blue">
                <span class="box-label">👩‍🎓 학급 설정 (처음 1회만)</span>
                <p class="onboard-desc">
                    선생님이 알려준 학급 정보를 입력해주세요.<br>한 번만 입력하면 다음부터 자동 로그인됩니다!
                </p>
                <label>학급명</label>
                <input type="text" id="onboardClassName" placeholder="예: 부평서초6-1" required>
                <label>클래스 코드</label>
                <input type="text" id="onboardClassCode" placeholder="선생님이 알려준 코드 (예: 부평서초34)" maxlength="20" required>
                <label>나의 번호</label>
                <input type="number" id="onboardStudentNumber" placeholder="번호 입력 (예: 15)" required>
                <button type="button" id="saveOnboardBtn" onclick="saveStudentOnboarding()"
                    class="btn-onboard-student">설정 완료</button>
                <div id="onboardMsg" class="message"></div>
            </div>
        </div>

        <!-- 교사 온보딩 (첫 사용자) -->
        <div id="teacherOnboardingSection" class="hidden">
            <h1 class="app-title">
                <img class="floating-emoji app-brand-icon" src="images/Gemini_Generated_Image_d19ctrd19ctrd19c-removebg-preview.png" alt="배움로그 아이콘">
                <span class="app-title-text">배움로그</span>
            </h1>
            <div class="top-action-row-end">
                <button onclick="logoutGoogle()"
                    class="btn-logout-compact">로그아웃</button>
            </div>
            <div class="accent-box box-violet">
                <span class="box-label">👨‍🏫 클래스 만들기 (처음 1회만)</span>
                <p class="onboard-desc">
                    ✨ 새 클래스를 만들어보세요!<br>한 번만 설정하면 다음부터 자동으로 접속됩니다.
                </p>
                <label>학급명 설정</label>
                <input type="text" id="newOnboardClassName" placeholder="예: 부평서초6-1" required>
                <label>클래스 코드 설정</label>
                <input type="text" id="newOnboardClassCode" placeholder="예: 부평서초34, math1" maxlength="20" required>
                <p class="onboard-hint">
                    1~10자리, 숫자·영문·한글 조합 가능</p>
                <button type="button" id="saveTeacherOnboardBtn" onclick="saveTeacherOnboarding()"
                    class="btn-onboard-teacher">클래스 생성하기</button>
                <div id="teacherOnboardMsg" class="message"></div>
            </div>
        </div>

        <!-- 학생 메인 (기존 사용자 / 온보딩 후) -->
        <div id="studentTab" class="hidden">
            <h1 class="app-title">
                <img class="floating-emoji app-brand-icon" src="images/Gemini_Generated_Image_d19ctrd19ctrd19c-removebg-preview.png" alt="배움로그 아이콘">
                <span class="app-title-text">배움로그</span>
            </h1>
            <div id="studentMainSection" class="hidden">
                <div class="student-header-row">
                    <span id="welcomeMsg" class="welcome-msg"></span>
                    <button onclick="logoutGoogle()"
                        class="btn-logout-main">로그아웃</button>
                </div>
                <!-- 기존 탭 내비게이션 (롤백용 주석 처리) -->
                <!-- <div class="mini-tab-container">
                    <button class="mini-tab-btn active-student" onclick="switchStudentMainTab('self')">💝 스스로 배움</button>
                    <button class="mini-tab-btn" onclick="switchStudentMainTab('peer')">👥 친구로 배움</button>
                    <button class="mini-tab-btn" onclick="switchStudentMainTab('praise')">💌 칭찬 우체통</button>
                    <button class="mini-tab-btn" onclick="switchStudentMainTab('settings')">⚙️ 설정</button>
                </div> -->

                <!-- 새로운 하단 내비게이션 바 -->
                <nav class="bottom-nav">
                    <button class="nav-item active-nav" onclick="switchStudentMainTab('self')">
                        <span class="nav-icon">💝</span>
                        <span class="nav-label">스스로 배움</span>
                    </button>
                    <button class="nav-item" onclick="switchStudentMainTab('peer')">
                        <span class="nav-icon">👥</span>
                        <span class="nav-label">친구로 배움</span>
                    </button>
                    <button class="nav-item" onclick="switchStudentMainTab('praise')">
                        <span class="nav-icon">💌</span>
                        <span class="nav-label">칭찬 우체통</span>
                    </button>
                    <button class="nav-item" onclick="switchStudentMainTab('settings')">
                        <span class="nav-icon">⚙️</span>
                        <span class="nav-label">설정</span>
                    </button>
                </nav>

                <!-- 배움노트 섹션 -->
                <div id="selfEvaluationSection">
                    <!-- 성향 진단 화면 -->
                    <div id="personalityQuiz" class="hidden">
                        <div class="accent-box box-violet">
                            <span class="box-label">🧠 나의 성장 파트너 찾기</span>
                            <p class="personality-quiz-desc">
                                8개의 질문으로, 나를 더 잘 성장시키는<br>
                                조언 스타일을 찾아요!
                            </p>
                            <div id="quizContent"></div>
                            <button id="submitQuizBtn" class="hidden personality-submit-btn" onclick="submitPersonalityQuiz()">분석 완료</button>
                        </div>
                    </div>

                    <!-- 성향 결과 화면 -->
                    <div id="personalityResult" class="hidden">
                        <div class="accent-box" id="personalityCard">
                            <div class="personality-result-head">
                                <div id="personalityIcon" class="personality-icon-large"></div>
                                <h3 id="personalityTitle" class="personality-title"></h3>
                                <div id="personalityDesc" class="personality-desc"></div>
                            </div>
                            <div id="allPersonalityTypes" class="personality-types-wrap"></div>
                            <div class="personality-result-actions">
                                <button onclick="confirmPersonalityResult()"
                                    class="personality-confirm-btn">확인하고
                                    시작하기</button>
                                <button onclick="resetPersonalityFromSettings()"
                                    class="personality-reset-btn">다시
                                    진단하기</button>
                            </div>
                        </div>
                    </div>

                    <!-- 배움노트 메뉴 -->
                    <div id="selfEvaluationMenu" class="hidden">
                        <div class="sub-tab-container">
                            <button class="sub-tab-btn active" onclick="switchSelfTab('daily')">📝 배움 노트</button>
                            <button class="sub-tab-btn" onclick="switchSelfTab('project')">🌟 프로젝트 돌아보기</button>
                            <button class="sub-tab-btn" onclick="switchSelfTab('dashboard')">📊 결과보기</button>
                        </div>
                        <div class="accent-box box-violet class-tone-section self-date-card">
                            <label>조회/기록 날짜</label>
                            <input type="date" id="selfDate" class="class-tone-input diary-date-input" required
                                onchange="syncAllDates(this.value); loadDailyReflection()">
                        </div>

                        <!-- 배움 노트 탭 -->
                        <div id="dailyReflectionTab">
                            <div class="accent-box box-blue">
                                <span class="box-label">📚 오늘의 배움</span>
                                <div class="guide-buttons guide-scroll-row">
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uC624\uB298 \uBC30\uC6B4 \uB0B4\uC6A9: \n', 'learningText')">&#x1F4D8; &#xC624;&#xB298; &#xBC30;&#xC6B4; &#xB0B4;&#xC6A9;</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uB0B4\uAC00 \uC798\uD55C \uC810: \n', 'learningText')">&#x2705; &#xB0B4;&#xAC00; &#xC798;&#xD55C; &#xC810;</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uC5B4\uB824\uC6E0\uB358 \uC810: \n', 'learningText')">&#x1F635; &#xC5B4;&#xB824;&#xC6E0;&#xB358; &#xC810;</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uC774\uD574/\uD574\uACB0 \uBC29\uBC95: \n', 'learningText')">&#x1F4A1; &#xC774;&#xD574;/&#xD574;&#xACB0; &#xBC29;&#xBC95;</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uC544\uC9C1 \uD5F7\uAC08\uB9AC\uB294 \uC810: \n', 'learningText')">&#x2753; &#xC544;&#xC9C1; &#xD5F7;&#xAC08;&#xB9AC;&#xB294; &#xC810;</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('\uC77C\uC0C1\uC5D0 \uC801\uC6A9\uD574\uBCFC \uC810: \n', 'learningText')">&#x1F331; &#xC77C;&#xC0C1;&#xC5D0; &#xC801;&#xC6A9;&#xD574;&#xBCFC; &#xC810;</button>

                                </div>
                                <textarea id="learningText"
                                    placeholder="📚 오늘 배운 내용: 국어 토론에서 발표 논리와 표현을 정리하고, 사회 자료를 읽으며 핵심 문장을 표시했어.&#10;✅ 내가 잘한 점: 수학 계산과 과학 실험 기록을 순서대로 정리해서 실수를 줄였고, 영어 문장을 끝까지 읽고 근거를 찾았어.&#10;😵 어려웠던 점: 체육 활동 뒤 집중을 다시 올리는 게 어려웠고, 음악·미술·도덕·실과 내용을 한 번에 연결해 설명하는 게 헷갈렸어.&#10;💡 이해/해결 방법: 모둠활동에서 친구와 역할을 나눠 토론하고, 발표 전에 핵심 키워드 3개를 먼저 적은 뒤 기타 활동 메모까지 붙여 흐름을 맞췄어.&#10;❓ 아직 헷갈리는 점: 자료 근거를 더 짧게 요약해 말하는 연습이 필요해.&#10;🌱 일상에 적용해볼 점: 내일은 태그(국어·수학·사회·과학·영어·음악·미술·체육·도덕·실과·토론·발표·모둠활동·기타)를 기준으로 복습 노트를 만들어볼래."
                                    class="student-note-textarea"></textarea>
                                <label class="subject-tag-label">과목/활동 태그 (여러 개 선택 가능)</label>
                                <div class="subject-tags student-tags-wrap">
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('국어')">📖
                                        국어</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('수학')">🔢
                                        수학</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('사회')">🌍
                                        사회</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('과학')">🔬
                                        과학</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('영어')">🔤
                                        영어</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('음악')">🎵
                                        음악</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('미술')">🎨
                                        미술</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('체육')">⚽
                                        체육</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('도덕')">💛
                                        도덕</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('실과')">🔧
                                        실과</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('토론')">💬
                                        토론</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('발표')">🎤
                                        발표</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('모둠활동')">👥
                                        모둠활동</button>
                                    <button type="button" class="subject-tag-btn" onclick="toggleSubjectTag('기타')">✨
                                        기타</button>
                                </div>
                            </div>

                            <button type="button" id="saveDailyBtn" onclick="submitDailyReflection()"
                                class="btn-save-daily">저장하기</button>
                            <div id="dailyMsg" class="message"></div>
                            <div id="aiFeedbackSection" class="hidden ai-feedback-section">
                                <div class="accent-box ai-feedback-card">
                                    <div class="ai-feedback-head">
                                        <span class="ai-feedback-icon">💬</span>
                                        <span class="ai-feedback-title">성장 파트너의
                                            한마디</span>
                                    </div>
                                    <div id="aiFeedbackText" class="ai-feedback-text"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 성장 대시보드 탭 -->
                        <div id="dashboardTab" class="hidden">
                            <div class="accent-box dashboard-overview-card">
                                <span class="box-label">📌 나의 성장 요약</span>
                                <div id="streakBadgeArea" class="streak-badge-area dashboard-overview-streak">
                                    <div id="streakDisplay" class="streak-display"></div>
                                    <div id="badgeContainer" class="badge-container-center"></div>
                                </div>
                                <div class="dashboard-overview-divider"></div>
                                <div class="dashboard-overview-keywords">
                                    <div class="dashboard-overview-subtitle">나의 성장 신호</div>
                                    <div id="learningWordCloud" class="word-cloud">
                                        <div class="empty-state">
                                            <div class="empty-desc">신호를 보려면 기록이 필요해요.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="accent-box summary-report-card dashboard-ai-card">
                                <span class="box-label">💬 성장 파트너의 메시지</span>
                                <div class="partner-message-mode-row">
                                    <button type="button" class="partner-message-mode-btn active" data-mode="daily"
                                        onclick="generatePartnerMessage('daily')">🗒️ 일간 피드백</button>
                                    <button type="button" class="partner-message-mode-btn" data-mode="compare"
                                        onclick="generatePartnerMessage('compare')">🔎 기록 비교 피드백</button>
                                </div>
                                <div id="partnerDailyActionRow" class="partner-daily-action-row">
                                    <button type="button" class="partner-daily-generate-btn"
                                        onclick="generateDailyPartnerMessage()">일간 피드백 생성하기</button>
                                </div>
                                <div id="partnerComparePanel" class="partner-compare-panel hidden">
                                    <div class="partner-compare-toolbar">
                                        <div class="partner-compare-target-row">
                                            <button type="button" id="partnerCompareTargetABtn"
                                                class="partner-compare-target-btn is-active"
                                                onclick="setPartnerCompareTarget('A')">A 선택중</button>
                                            <button type="button" id="partnerCompareTargetBBtn"
                                                class="partner-compare-target-btn"
                                                onclick="setPartnerCompareTarget('B')">B 선택</button>
                                        </div>
                                        <div class="partner-compare-month-row">
                                            <button type="button" class="partner-compare-month-btn"
                                                onclick="navigatePartnerCompareMonth(-1)"
                                                aria-label="이전 달">‹</button>
                                            <span id="partnerCompareMonthLabel"
                                                class="partner-compare-month-label">-</span>
                                            <select id="partnerCompareMonthSelect" class="partner-compare-month-select"
                                                onchange="setPartnerCompareMonth(this.value)"
                                                aria-label="비교 달 선택"></select>
                                            <button type="button" class="partner-compare-month-btn"
                                                onclick="navigatePartnerCompareMonth(1)"
                                                aria-label="다음 달">›</button>
                                        </div>
                                    </div>
                                    <div id="partnerCompareCalendar" class="partner-compare-calendar">
                                        <div class="empty-state"><span class="empty-icon">🗓️</span>
                                            <div class="empty-desc">비교할 날짜를 선택해 주세요.</div>
                                        </div>
                                    </div>
                                    <div id="partnerCompareSelectionSummary" class="partner-compare-selection-summary">
                                        A와 B 날짜를 달력에서 선택해 주세요.
                                    </div>
                                    <button type="button" id="partnerCompareGenerateBtn"
                                        class="partner-compare-generate-btn" onclick="generateComparePartnerMessage()"
                                        disabled>비교 피드백 생성</button>
                                </div>
                                <div id="summaryReportArea">
                                    <div class="empty-state"><span class="empty-icon">💬</span>
                                        <div class="empty-desc">모드를 고른 뒤 피드백 생성 버튼을 눌러 메시지를 받아보세요.</div>
                                    </div>
                                </div>
                            </div>

                            <details class="accent-box dashboard-history-accordion">
                                <summary class="dashboard-history-summary">
                                    <span class="dashboard-history-title">📊 나의 기록 히스토리</span>
                                    <span class="dashboard-history-state" aria-hidden="true"></span>
                                </summary>
                                <div class="dashboard-history-content">
                                    <div class="dashboard-history-panel">
                                        <div class="dashboard-history-panel-title">과목별 기록</div>
                                        <div id="subjectChart" class="subject-chart">
                                            <div class="empty-state"><span class="empty-icon">📚</span>
                                                <div class="empty-desc">과목 태그를 선택하면 통계가 보여요!</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="dashboard-history-panel">
                                        <div class="dashboard-history-panel-title">기록 캘린더</div>
                                        <div id="recordHeatmap" class="record-heatmap">
                                            <div class="empty-state"><span class="empty-icon">🗓️</span>
                                                <div class="empty-desc">올해 기록을 달력으로 볼 수 있어요.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="dashboard-history-detail">
                                    <div id="historyFilterSummary" class="history-filter-summary">
                                        <span class="history-filter-placeholder">과목 바 또는 날짜를 선택하면 관련 기록이 표시됩니다.</span>
                                    </div>
                                    <div id="historyDetailList" class="history-detail-list">
                                        <div class="empty-state"><span class="empty-icon">👈</span>
                                            <div class="empty-desc">먼저 과목 또는 날짜를 선택해 주세요.</div>
                                        </div>
                                    </div>
                                </div>
                                <details class="dashboard-history-best">
                                    <summary class="dashboard-history-best-summary">
                                        <span class="dashboard-history-panel-title">나의 베스트 기록</span>
                                        <span class="dashboard-history-best-state" aria-hidden="true"></span>
                                    </summary>
                                    <div class="dashboard-history-best-content">
                                        <div id="bestRecordList" class="best-record-list">
                                            <div class="empty-state"><span class="empty-icon">🏅</span>
                                                <div class="empty-desc">기록이 쌓이면 베스트 기록이 보여요.</div>
                                            </div>
                                        </div>
                                    </div>
                                </details>
                            </details>
                        </div>

                        <div id="projectReflectionTab" class="hidden">
                            <div class="accent-box box-amber">
                                <span class="box-label">🌟 프로젝트 돌아보기</span>
                                <label>프로젝트 이름</label>
                                <input type="text" id="projectName" placeholder="예: 세계 여행 가이드북 만들기">

                                <div class="guide-buttons guide-scroll-row">
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('👍 잘된 점: \n', 'projectComment')">👍 잘된 점</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('🤔 아쉬운 점/어려웠던 점: \n', 'projectComment')">🤔 아쉬운
                                        점</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('✨ 인상적인 순간/배운 점: \n', 'projectComment')">✨
                                        인상/배움</button>

                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('💪 다음 도전: \n', 'projectComment')">💪 다음 도전</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('🎯 다음을 위한 팁: \n', 'projectComment')">🎯 다음 팁</button>
                                </div>
                                <textarea id="projectComment" placeholder="👍 잘된 점: 프로젝트에서 국어·사회 자료를 비교해 핵심을 정리하고, 수학·과학 근거를 넣어 설명 흐름이 또렷했어.&#10;🤔 아쉬운 점/어려웠던 점: 영어 표현, 음악·미술 사례, 체육·도덕·실과 연결 포인트를 한 번에 담으려다 문장이 길어졌어.&#10;✨ 인상적인 순간/배운 점: 토론으로 의견을 모으고 모둠활동 발표에서 역할을 나눴더니 전달이 훨씬 안정적이었어.&#10;💪 다음 도전: 기타 자료까지 포함해 태그(국어·수학·사회·과학·영어·음악·미술·체육·도덕·실과·토론·발표·모둠활동·기타)를 모두 반영한 1페이지 요약본을 만들래.&#10;🎯 다음을 위한 팁: 슬라이드마다 결론 한 줄 → 근거 두 줄 순서로 고정하면 메시지가 더 선명해져."
                                    class="student-note-textarea"></textarea>
                            </div>
                            <button type="button" id="submitProjectBtn" onclick="submitProjectReflection()"
                                class="btn-project-submit">제출</button>
                            <div id="projectMsg" class="message"></div>
                            <div id="projectAIAnalysis" class="hidden ai-encouragement">
                                <div class="ai-icon">🤖</div>
                                <div id="projectAIText"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 친구로 배움 섹션 -->
                <div id="peerEvaluationSection" class="hidden">
                    <div class="sub-tab-container">
                        <button class="sub-tab-btn active" onclick="switchPeerTab('submit')">📝 평가하기</button>
                        <button class="sub-tab-btn" onclick="switchPeerTab('result')">📊 결과보기</button>
                    </div>
                    <div id="studentSubmitTab">
                        <form id="reviewForm">
                            <label>평가 날짜</label>
                            <input type="date" id="reviewDate" class="class-tone-input diary-date-input" required
                                onchange="syncAllDates(this.value)">
                            <div class="type-selector">
                                <label><input type="radio" name="evalTypeDisplay" value="individual"
                                        onchange="switchTypeAndLogout('individual')"> 👤 개인평가</label>
                                <label><input type="radio" name="evalTypeDisplay" value="group"
                                        onchange="switchTypeAndLogout('group')"> 👥 모둠평가</label>
                            </div>
                            <div class="accent-box box-blue">
                                <span class="box-label">🎯 학습 목표 및 평가 과제</span>
                                <div id="objectiveArea" class="objective-area">
                                    <div class="objective-label">
                                        학습 목표</div>
                                    <div id="objectiveText" class="objective-text">등록된 학습목표가 없습니다.</div>
                                </div>
                                <div id="taskArea" class="task-area">
                                    <div class="objective-label">
                                        평가 과제</div>
                                    <div id="taskText" class="objective-text">등록된 평가과제가 없습니다.</div>
                                </div>
                            </div>
                            <div class="accent-box box-teal">
                                <span class="box-label">📝 평가 정보 입력</span>
                                <label id="submitReviewerLabel">나의 번호</label>
                                <input type="text" id="reviewerId" readonly class="reviewer-input-readonly">
                                <label id="submitTargetLabel">평가 대상 선택</label>
                                <div id="progressArea" class="progress-area">
                                    <div class="progress-text" id="progressText">평가 진행: 0 / 0명</div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar-fill progress-bar-zero" id="progressBar"></div>
                                    </div>
                                </div>
                                <div id="targetGrid" class="target-grid"></div>
                                <input type="hidden" id="targetId">
                            </div>
                            <div id="ratingSection" class="accent-box box-amber hidden">
                                <span class="box-label">평가 기준</span>
                                <div id="ratingItems"></div>
                            </div>
                            <div class="accent-box box-green">
                                <span class="box-label">💬 서로의 발전을 돕는 피드백</span>
                                <div class="feedback-templates guide-scroll-row">
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('👍 잘한 점: \n')">👍
                                        잘한 점</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('💡 이렇게 하면 더 좋을 것 같아: \n')">💡 개선 제안</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('✨ 특히 인상적이었던 부분은 \n')">✨ 인상적인 부분</button>
                                    <button type="button" class="template-btn"
                                        onclick="insertTemplate('💪 다음에는 이런 점을 시도해보면 좋겠어: \n')">💪 다음 도전</button>
                                </div>
                                <textarea id="reviewContent"
                                    placeholder="👍 잘한 점: 국어·토론·발표에서 핵심을 먼저 말하고, 사회·과학 근거를 붙여서 듣는 사람이 이해하기 쉬웠어.&#10;💡 이렇게 하면 더 좋을 것 같아: 수학·영어 표현을 한 줄 더 보완하고, 음악·미술 예시를 짧게 넣으면 메시지가 더 풍부해질 것 같아.&#10;✨ 특히 인상적이었던 부분은: 체육·도덕·실과 활동 내용을 모둠활동으로 연결해 역할 분담을 끝까지 지킨 점이 좋았어.&#10;💪 다음에는 이런 점을 시도해보면 좋겠어: 기타 자료까지 포함해 태그(국어·수학·사회·과학·영어·음악·미술·체육·도덕·실과·토론·발표·모둠활동·기타)를 체크한 뒤 피드백을 작성해봐." required
                                    minlength="100" oninput="updateCharCount()"
                                    class="review-content-textarea"></textarea>
                                <div id="charCount" class="char-count-right">
                                    0자 /
                                    최소 100자</div>
                            </div>
                            <button type="submit" id="submitBtn" class="not-ready">평가 제출하기</button>
                        </form>
                        <div id="submitMsg" class="message"></div>
                    </div>
                    <div id="studentResultTab" class="hidden">
                        <div class="type-selector type-selector-gap-20">
                            <label><input type="radio" name="resultEvalTypeDisplay" value="individual"
                                    onchange="switchTypeAndLogout('individual')"> 👤 개인평가</label>
                            <label><input type="radio" name="resultEvalTypeDisplay" value="group"
                                    onchange="switchTypeAndLogout('group')"> 👥 모둠평가</label>
                        </div>
                        <div class="accent-box box-amber class-tone-section">
                            <span class="box-label">결과 조회</span>
                            <label>조회 날짜</label>
                            <input type="date" id="viewDate" class="class-tone-input diary-date-input" required
                                onchange="syncAllDates(this.value)">
                            <button type="button" id="viewResultBtn" onclick="viewMyResult()">💬 성장 파트너의 메시지 받기</button>
                        </div>
                        <div id="viewMsg" class="message"></div>
                        <div id="resultArea" class="hidden result-area-gap">
                            <div id="statsSummary" class="stats-summary"></div>
                            <div id="chartContainer" class="chart-container hidden">
                                <h4>📊 항목별 점수 현황</h4>
                                <div id="barChart" class="bar-chart"></div>
                            </div>
                            <div class="accent-box box-violet">
                                <span class="box-label summary-title-gap">💬 성장 파트너의 메시지</span>
                                <div id="mySummary" class="summary-text-main"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 우체통 섹션 -->
                <div id="praiseSection" class="hidden">
                    <div class="sub-tab-container sub-tab-gap-20">
                        <button class="sub-tab-btn active" onclick="switchPraiseTab('send')">💌 칭찬 보내기</button>
                        <button class="sub-tab-btn" onclick="switchPraiseTab('received')">📬 받은 칭찬</button>
                        <button class="sub-tab-btn" onclick="switchPraiseTab('teacher')">💌 선생님께 편지</button>
                    </div>
                    <div id="praiseSendTab">
                        <div class="accent-box class-tone-section">
                            <span class="box-label">💌 친구에게 칭찬 보내기</span>
                            <label>받는 친구 번호</label>
                            <div id="praiseTargetGrid" class="target-grid target-grid-gap"></div>
                            <input type="hidden" id="praiseTargetId">
                            <div class="type-selector type-selector-gap-10">
                                <label><input type="radio" name="praiseAnon" value="anonymous" checked> 🎭 익명</label>
                                <label><input type="radio" name="praiseAnon" value="named"> 😊 이름 밝히기</label>
                            </div>
                            <textarea id="praiseContent" placeholder="친구에게 전하고 싶은 칭찬이나 감사의 말을 써주세요! (최소 10자)"
                                minlength="10" class="textarea-gap-5" oninput="updatePraiseCharCount()"></textarea>
                            <div id="praiseCharCount"
                                class="char-count-right">0자 / 최소 10자</div>
                            <button type="button" id="praiseSendBtn" onclick="sendPraise()">칭찬 보내기 💝</button>
                            <div id="praiseMsg" class="message"></div>
                        </div>
                    </div>
                    <div id="praiseReceivedTab" class="hidden">
                        <div class="accent-box box-violet">
                            <span class="box-label">📬 나에게 온 칭찬</span>
                            <div id="receivedPraiseList">
                                <div class="empty-state"><span class="empty-icon">💌</span>
                                    <div class="empty-title">아직 받은 칭찬이 없어요</div>
                                    <div class="empty-desc">친구들의 칭찬이 도착하면<br>여기에 표시됩니다!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 선생님께 편지 탭 -->
                    <div id="teacherMessageTab" class="hidden">
                        <div class="accent-box box-teal teacher-message-box-flat" id="teacherMessageBox">
                            <span class="box-label">💬 선생님께 전하고 싶은 말</span>
                            <div class="message-mode-selector">
                                <button type="button" class="mode-btn" id="anonymousBtn"
                                    onclick="toggleMessageMode('anonymous')">
                                    익명으로
                                </button>
                                <button type="button" class="mode-btn" id="namedBtn"
                                    onclick="toggleMessageMode('named')">
                                    이름 밝히고
                                </button>
                            </div>
                            <div id="messageInputArea" class="hidden message-input-gap">
                                <div id="messageModeBadge" class="message-mode-badge">
                                </div>
                                <textarea id="teacherMessage" placeholder="선생님께 하고 싶은 말을 자유롭게 써보세요"
                                    class="teacher-message-textarea"></textarea>
                                <div class="message-input-actions">

                                    <button type="button" id="sendTeacherMsgBtn" onclick="submitTeacherMessageOnly()"
                                        class="teacher-msg-send-btn">보내기</button>
                                </div>
                                <div id="teacherMsgResult" class="message"></div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- 학생 설정 섹션 -->
                <div id="studentSettingsSection" class="hidden">
                    <!-- 박스 1: 나의 학급 정보 -->
                    <div class="accent-box student-settings-card">
                        <span class="box-label">📚 나의 학급 정보</span>
                        <div class="student-settings-stack">
                            <div class="student-class-info-row">
                                <span class="student-class-info-key">학급명</span>
                                <span id="settingsClassName" class="student-class-info-value">-</span>
                            </div>
                            <div class="student-class-info-row">
                                <span class="student-class-info-key">학급 코드</span>
                                <span id="settingsClassCode" class="student-class-info-value">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- 박스 2: 나의 성장 파트너 (성향 진단) -->
                    <div class="accent-box student-settings-card">
                        <span class="box-label">🧠 나의 성장 파트너</span>
                        <div id="settingsPersonalityArea" class="settings-personality-area">
                            <p class="settings-personality-loading">로딩 중...</p>
                        </div>
                    </div>

                    <!-- 박스 3: 학급 변경 -->
                    <div class="accent-box class-tone-section student-class-change-card">
                        <span class="box-label">🔄 학급 변경</span>
                        <p class="student-class-change-warning">
                            ⚠️ 학급을 변경하면 기존 데이터(일기, 평가, 칭찬 등)가 <strong>모두 삭제</strong>됩니다.
                        </p>
                        <div class="student-class-change-field">
                            <label>새 학급명</label>
                            <input type="text" id="newClassNameInput" placeholder="이동할 학급명 입력 (예: 부평서초6-1)"
                                class="student-class-change-input">
                        </div>
                        <div class="student-class-change-field">
                            <label>새 학급 코드</label>
                            <input type="text" id="newClassCodeInput" placeholder="이동할 학급 코드 입력"
                                class="student-class-change-input">
                        </div>
                        <button type="button" onclick="changeClassAndReset()"
                            class="student-class-change-btn">학급 변경하기</button>
                    </div>
                </div>
            </div>

        </div>

        <!-- 교사 메인 (기존 사용자 / 온보딩 후) -->
        <div id="teacherTab" class="hidden">
            <h1 class="app-title">
                <img class="floating-emoji app-brand-icon" src="images/Gemini_Generated_Image_d19ctrd19ctrd19c-removebg-preview.png" alt="배움로그 아이콘">
                <span class="app-title-text">배움로그</span>
            </h1>
            <div id="teacherMain" class="hidden">
                <div class="teacher-top-actions">
                    <button onclick="logoutGoogle()"
                        class="teacher-logout-btn">로그아웃</button>
                </div>
                <!-- 새로운 하단 내비게이션 바 (교사용) -->
                <nav class="bottom-nav teacher-bottom-nav">
                    <button class="nav-item active-nav" onclick="switchMiniTab('diary')">
                        <span class="nav-icon">💝</span>
                        <span class="nav-label">스스로 배움</span>
                    </button>
                    <button class="nav-item" onclick="switchMiniTab('review')">
                        <span class="nav-icon">👥</span>
                        <span class="nav-label">친구로 배움</span>
                    </button>
                    <button class="nav-item" onclick="switchMiniTab('praise')">
                        <span class="nav-icon">💌</span>
                        <span class="nav-label">칭찬 우체통</span>
                    </button>
                    <button class="nav-item" onclick="switchMiniTab('settings')">
                        <span class="nav-icon">👤</span>
                        <span class="nav-label">관리</span>
                    </button>
                </nav>
                <!-- 친구로 배움 하위 탭 -->
                <div id="reviewSubTabArea" class="hidden">
                    <div class="sub-tab-container sub-tab-gap-15">
                        <button class="sub-tab-btn active" onclick="switchReviewSubTab('ranking')">📊 전체 현황</button>
                        <button class="sub-tab-btn" onclick="switchReviewSubTab('student')">👤 개별 현황</button>
                        <button class="sub-tab-btn" onclick="switchReviewSubTab('criteria')">📅 기준 설정</button>
                    </div>
                </div>
                <div id="rankStudentArea" class="accent-box box-violet rank-student-area-card">
                    <div class="stats-filter-container rank-filter-row">
                        <div class="rank-filter-date-wrap">
                            <label class="diary-date-label">📅 조회 날짜</label>
                            <input type="date" id="teacherDate" class="class-tone-input diary-date-input" required
                                onchange="syncAllDates(this.value); loadTeacherData()">
                        </div>
                        <div class="type-selector rank-filter-type-selector">
                            <label class="rank-filter-option-label">
                                <input type="radio" name="teacherEvalType" value="individual" checked
                                    onchange="loadTeacherData()"> 👤 개인</label>
                            <label class="rank-filter-option-label">
                                <input type="radio" name="teacherEvalType" value="group" onchange="loadTeacherData()">
                                👥 모둠</label>
                        </div>
                    </div>
                </div>
                <div id="rankingMiniTab">
                    <div id="teacherDashboard" class="stats-summary teacher-dashboard-gap"></div>
                    <h3>친구로배움 현황 (내림차순)</h3>
                    <div class="ranking-table-wrapper ranking-table-scroll">
                        <div id="rankingTable"></div>
                    </div>
                </div>
                <div id="studentMiniTab" class="hidden">
                    <h3>대상 번호 선택</h3>
                    <div id="studentSelector" class="student-selector"></div>
                    <div id="studentReviews"></div>
                </div>
                <div id="diaryMiniTab" class="hidden">
                    <div class="sub-tab-container sub-tab-gap-15">
                        <button type="button" class="sub-tab-btn active" onclick="switchTeacherDiarySubTab('overview')">📊 참여현황</button>
                        <button type="button" class="sub-tab-btn" onclick="switchTeacherDiarySubTab('student')">📝 개별보기</button>
                        <button type="button" class="sub-tab-btn" onclick="switchTeacherDiarySubTab('hint')">🧭 수업 개선 단서</button>
                        <button type="button" class="sub-tab-btn" onclick="switchTeacherDiarySubTab('comment')">🧑‍🏫 세특생성</button>
                    </div>

                    <div id="teacherDiaryOverviewTab">
                    <div class="accent-box box-violet">
                        <span class="box-label">📊 배움노트 참여 현황</span>
                        <div class="diary-date-filter-wrap">
                            <label class="diary-date-label">📅 조회 날짜</label>
                            <input type="date" id="diaryViewDate" class="class-tone-input diary-date-input"
                                onchange="handleTeacherDiaryDateChange('diaryViewDate')">
                        </div>
                        <div class="stats-summary diary-overview-stats">
                            <div class="stat-card">
                                <span class="stat-number" id="totalReflections">0</span>
                                <span class="stat-label">총 작성 수</span>
                            </div>
                            <div class="stat-card blue">
                                <span class="stat-number" id="todayReflections">0</span>
                                <span class="stat-label">선택 날짜 작성</span>
                            </div>
                        </div>
                        <div class="diary-completion-wrap">
                            <span class="box-label diary-completion-label">🧾 배움노트 제출 확인</span>
                            <div id="diaryCompletionSummary" class="diary-completion-summary"></div>
                            <div id="diaryCompletionList" class="diary-completion-list"></div>
                        </div>
                    </div>
                    </div>

                    <div id="teacherDiaryStudentTab" class="hidden">
                    <div class="accent-box box-teal">
                        <span class="box-label">👤 개별 배움노트</span>
                        <div class="diary-date-filter-wrap">
                            <label class="diary-date-label">📅 조회 날짜</label>
                            <input type="date" id="diaryStudentViewDate" class="class-tone-input diary-date-input"
                                onchange="handleTeacherDiaryDateChange('diaryStudentViewDate')">
                        </div>
                        <div class="diary-student-selector-wrap">
                            <label class="form-label">학생 번호 선택</label>
                            <div id="diaryStudentSelectorList" class="diary-student-selector-grid"></div>
                        </div>
                        <div id="diaryStudentDetail" class="diary-student-detail">
                            <div class="empty-state">
                                <span class="empty-icon">📝</span>
                                <div class="empty-desc">학생 번호를 누르면 해당 학생이 오늘 쓴 배움노트를 볼 수 있습니다.</div>
                            </div>
                        </div>
                    </div>
                    </div>

                    <div id="teacherDiaryHintTab" class="hidden">
                    <div id="emotionAlertArea" class="accent-box box-violet hidden">
                        <span class="box-label">🧭 수업 개선 단서</span>
                        <div class="diary-date-filter-wrap">
                            <label class="diary-date-label">📅 조회 날짜</label>
                            <input type="date" id="diaryHintViewDate" class="class-tone-input diary-date-input"
                                onchange="handleTeacherHintDateChange()">
                        </div>
                        <p class="emotion-alert-desc">
                            1단계 날짜(이 탭 조회 날짜) → 2단계 과목 → 3단계 단서 유형(어려운 점/헷갈리는 점/아직 미해결) 순서로 확인합니다. (카드를 누르면 해당 학생 노트로 이동)
                        </p>
                        <div class="difficulty-map-filter-split">
                            <div class="difficulty-map-filter-col">
                                <div class="difficulty-map-filter-col-title">2단계 과목</div>
                                <div id="difficultyMapTagSummary" class="difficulty-map-tag-summary"></div>
                            </div>
                            <div class="difficulty-map-filter-col">
                                <div class="difficulty-map-filter-col-title">3단계 단서 유형</div>
                                <div id="difficultyMapSignalSummary" class="difficulty-map-tag-summary difficulty-map-signal-summary"></div>
                            </div>
                        </div>
                        <div id="difficultyMapFilterHint" class="difficulty-map-filter-hint hidden"></div>
                        <div id="emotionAlertList"></div>
                    </div>
                    </div>

                    <!-- 교과세특(평어) 생성: 배움노트 기반 -->

                    <div id="teacherDiaryCommentTab" class="hidden">
                    <div id="teacherSubjectCommentSection" class="teacher-subject-comment-card">
                        <span class="box-label">🧑‍🏫 배움노트 기반 교과세특 (평어) 생성</span>
                        <p class="teacher-subject-comment-desc">
                            학생이 한 학기 동안 쓴 배움노트를 근거로, 생활기록부 속 교과 세부 특기 사항 문장을 생성합니다.
                        </p>

                        <div class="teacher-subject-comment-settings">
                            <div class="teacher-subject-comment-row teacher-subject-comment-row-single teacher-subject-comment-row-student">
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">현재 선택 학생</label>
                                    <div id="teacherSubjectCommentStudentPicker" class="teacher-subject-comment-student-picker">
                                        <button type="button" id="teacherSubjectCommentStudent" class="teacher-subject-comment-pill teacher-subject-comment-student-trigger" onclick="toggleTeacherSubjectCommentStudentMenu()">미선택</button>
                                        <div id="teacherSubjectCommentStudentMenu" class="teacher-subject-comment-student-menu hidden"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="teacher-subject-comment-row teacher-subject-comment-row-half teacher-subject-comment-row-settings">
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">학교급</label>
                                    <select id="teacherSubjectCommentSchoolLevel" class="class-tone-input teacher-subject-comment-input">
                                        <option value="">선택하세요</option>
                                        <option value="초">초</option>
                                        <option value="중">중</option>
                                        <option value="고">고</option>
                                    </select>
                                </div>
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">학기</label>
                                    <div class="teacher-subject-comment-seg">
                                        <button type="button" id="teacherSubjectCommentSemester1" class="seg-btn active" onclick="setTeacherSubjectCommentSemester(1)">1학기</button>
                                        <button type="button" id="teacherSubjectCommentSemester2" class="seg-btn" onclick="setTeacherSubjectCommentSemester(2)">2학기</button>
                                    </div>
                                </div>
                            </div>

                            <div class="teacher-subject-comment-row teacher-subject-comment-row-half teacher-subject-comment-row-period">
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">기간 시작일</label>
                                    <input type="date" id="teacherSubjectCommentStart" class="class-tone-input teacher-subject-comment-input">
                                </div>
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">기간 종료일</label>
                                    <input type="date" id="teacherSubjectCommentEnd" class="class-tone-input teacher-subject-comment-input">
                                </div>
                            </div>

                            <div class="teacher-subject-comment-row teacher-subject-comment-row-single teacher-subject-comment-row-tags">
                                <div class="teacher-subject-comment-field">
                                    <label class="form-label">과목 태그 (1개 선택)</label>
                                    <div id="teacherSubjectCommentSubjectTags" class="subject-tags teacher-subject-comment-tags"></div>
                                    <div id="teacherSubjectCommentCustomSubjectWrap" class="teacher-subject-comment-custom-wrap hidden">
                                        <input type="text" id="teacherSubjectCommentCustomSubjectInput" class="class-tone-input teacher-subject-comment-input" placeholder="기타 과목명 입력 (예: 물리, 지리, 프로그래밍)">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="teacher-subject-comment-actions">
                            <button type="button" id="teacherSubjectCommentPreviewBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-secondary" onclick="previewTeacherSubjectCommentSources()">조회하기</button>
                            <button type="button" id="teacherSubjectCommentGenerateBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-primary" onclick="generateTeacherSubjectComment(false)">생성하기</button>
                            <div class="teacher-subject-comment-action-row">
                                <button type="button" id="teacherSubjectCommentRegenerateBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-secondary" onclick="generateTeacherSubjectComment(true)">재생성</button>
                                <button type="button" id="teacherSubjectCommentSaveBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-secondary" onclick="saveTeacherSubjectComment(this)">저장</button>
                            </div>
                            <div class="teacher-subject-comment-action-row">
                                <button type="button" id="teacherSubjectCommentCopyBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-utility" onclick="copyTeacherSubjectComment()">복사</button>
                                <button type="button" id="teacherSubjectCommentExportBtn" class="teacher-subject-comment-btn teacher-subject-comment-btn-utility" onclick="openTeacherSubjectCommentExportModal()">.xlsx 다운로드</button>
                            </div>
                        </div>

                        <div id="teacherSubjectCommentResultWrap" class="teacher-subject-comment-result-wrap">
                            <div class="teacher-subject-comment-meta">
                                <span>배움노트 <strong id="teacherSubjectCommentNoteCount">-</strong>건</span>
                                <span id="teacherSubjectCommentStatus" class="teacher-subject-comment-status"></span>
                            </div>
                            <div id="teacherSubjectCommentSourceWrap" class="hidden teacher-subject-comment-source-wrap">
                                <div class="teacher-subject-comment-source-head">📚 선택 과목 원문 조회</div>
                                <div id="teacherSubjectCommentSourceList" class="teacher-subject-comment-source-list"></div>
                            </div>
                            <div id="teacherSubjectCommentEmpty" class="empty-state teacher-subject-comment-empty">
                                <span class="empty-icon">📚</span>
                                <div class="empty-title">설정을 선택해 생성해보세요</div>
                                <div class="empty-desc">학생/학기/기간/과목/학교급을 선택한 후 생성하기를 눌러주세요.</div>
                            </div>
                            <pre id="teacherSubjectCommentResult" class="teacher-subject-comment-result hidden"></pre>
                            <div id="teacherSubjectCommentError" class="message error teacher-subject-comment-error"></div>
                            <div id="teacherSubjectCommentRetry" class="hidden teacher-subject-comment-retry">
                                <button type="button" class="teacher-subject-comment-btn teacher-subject-comment-btn-secondary teacher-subject-comment-retry-btn" onclick="generateTeacherSubjectComment(true)">다시 시도</button>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                <div id="praiseMiniTab" class="hidden">
                    <div class="sub-tab-container sub-tab-gap-15">
                        <button id="teacherPraiseManageBtn" class="sub-tab-btn active"
                            onclick="switchTeacherPraiseSubTab('praise')">칭찬 관리</button>
                        <button id="teacherLetterManageBtn" class="sub-tab-btn"
                            onclick="switchTeacherPraiseSubTab('letter')">편지 관리</button>
                    </div>
                    <div id="teacherPraiseManagePanel">
                    <!-- 자동 승인 설정 -->
                    <div class="accent-box praise-approval-card">
                        <div class="praise-approval-head">
                            <span class="praise-approval-icon">✨</span>
                            <div>
                                <div class="praise-approval-title">칭찬 자동 승인 모드
                                </div>
                                <div class="praise-approval-desc">활성화하면 학생들의 칭찬이 대기 없이 즉시
                                    전달됩니다.
                                </div>
                            </div>
                        </div>
                        <label class="switch-container">
                            <input type="checkbox" id="autoApproveToggle" onchange="toggleAutoApprovePraise(this)">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <!-- 통계 요약 -->
                    <div id="praiseStatsArea" class="praise-stats-container">
                        <div class="praise-stat-card is-total">
                            <div class="praise-stat-value" id="praiseTotalCount">-
                            </div>
                            <div class="praise-stat-label">전체 칭찬</div>
                        </div>
                        <div class="praise-stat-card is-pending">
                            <div class="praise-stat-value" id="praisePendingCount">-
                            </div>
                            <div class="praise-stat-label">대기 중</div>
                        </div>
                        <div class="praise-stat-card is-approved">
                            <div class="praise-stat-value" id="praiseApprovedCount">
                                -
                            </div>
                            <div class="praise-stat-label">승인 완료</div>
                        </div>
                    </div>
                    <!-- 대기 중인 칭찬 -->
                    <div id="diaryParticipationCard" class="accent-box box-violet">
                        <span class="box-label">⏳ 승인 대기 중인 칭찬</span>
                        <div id="pendingPraiseList">
                            <div class="empty-state"><span class="empty-icon">💌</span>
                                <div class="empty-desc">대기 중인 칭찬이 없습니다</div>
                            </div>
                        </div>
                    </div>
                    <!-- 승인된 칭찬 전체 목록 -->
                    <div class="accent-box box-violet">
                        <span class="box-label">✅ 승인된 칭찬 목록</span>
                        <div id="approvedPraiseList">
                            <div class="empty-state"><span class="empty-icon">📬</span>
                                <div class="empty-desc">승인된 칭찬이 없습니다</div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <div id="teacherLetterManagePanel" class="hidden">
                    <!-- 학생 메시지 (배움노트에서 이전) -->
                    <div class="accent-box box-teal">
                        <span class="box-label">💬 학생 메시지</span>
                        <div class="teacher-message-date-wrap">
                            <label class="teacher-message-date-label">📅 조회
                                날짜</label>
                            <input type="date" id="messageViewDate" class="class-tone-input teacher-message-date-input"
                                onchange="loadTeacherMessages()">
                        </div>
                        <div id="messageList" class="teacher-message-list">
                            <div class="empty-state">
                                <span class="empty-icon">💌</span>
                                <div class="empty-title">메시지가 없습니다</div>
                                <div class="empty-desc">날짜를 선택하면<br>학생들의 메시지를 볼 수 있습니다.</div>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                <div id="criteriaMiniTab" class="hidden">
                    <div class="accent-box box-teal">
                        <span class="box-label">📅 날짜별 기준 설정</span>
                        <div
                            style="background:rgba(255,255,255,0.5); padding:15px; border-radius:10px; border:1px solid var(--border);">
                            <label style="display:block; margin-bottom:8px; font-family:'Jua', sans-serif;">📅 설정할
                                날짜</label>
                            <input type="date" id="settingDate"
                                style="width:100%; font-family:'Jua', sans-serif !important; font-size:1.05rem; margin-bottom:15px;"
                                onchange="syncAllDates(this.value); loadCriteriaForEdit()">
                            <label>🎯 학습 목표</label><input type="text" id="settingObjective"
                                placeholder="예: 세계의 다양한 기후와 지형에 따른 사람들의 생활 모습을 조사할 수 있다.">
                            <label>📋 평가 과제</label><input type="text" id="settingTask"
                                placeholder="예: 자신이 선택한 나라의 생활 모습을 조사하여 여행 가이드북 만들어 발표하기">
                            <button type="button" onclick="saveBasicInfo(this)" class="save-basic-btn">💾 1단계: 학습목표
                                및
                                평가과제 저장하기</button>
                            <p style="font-size:0.8rem; color:var(--text-sub); margin-top:-15px; text-align:center;">
                                ⚠️
                                평가기준을 AI로 생성하려면 이 버튼을 먼저 눌러 저장해야 합니다.</p>
                        </div>
                        <hr style="border:0; border-top:2px dashed var(--border); margin:25px 0;">
                        <div class="criteria-mode-header"
                            style="display:flex; justify-content:space-between; align-items:flex-end; margin-top:20px; margin-bottom:10px;">
                            <label style="margin:0; padding-bottom:5px;">📊 평가기준 설정 (2단계)</label>
                            <div class="mini-tab-container"
                                style="margin:0; padding:4px; max-width:280px; width:100%; display:flex; gap:5px;">
                                <button type="button" class="mini-tab-btn active-setting"
                                    onclick="switchCriteriaMode('auto')" id="autoModeBtn"
                                    style="flex:1; font-size:0.85rem; padding:8px 0;">✨ AI로 생성하기</button>
                                <button type="button" class="mini-tab-btn" onclick="switchCriteriaMode('manual')"
                                    id="manualModeBtn" style="flex:1; font-size:0.85rem; padding:8px 0;">✏️ 수동
                                    작성하기</button>
                            </div>
                        </div>
                        <div id="autoCriteriaArea">
                            <div
                                style="background:var(--bg-soft); padding:15px; border-radius:10px; margin-bottom:15px; border:1px solid var(--border);">
                                <div style="display:flex; gap:10px; margin-bottom:10px;">
                                    <div style="flex:1;"><label style="font-size:0.8rem;">학교급</label><select
                                            id="autoSchoolLevel" style="margin-bottom:0;"
                                            onchange="updateGradeOptions()">
                                            <option value="초등학교" selected>초등학교</option>
                                            <option value="중학교">중학교</option>
                                            <option value="고등학교">고등학교</option>
                                        </select></div>
                                    <div style="flex:1;"><label style="font-size:0.8rem;">학년</label><select
                                            id="autoGradeSelect" style="margin-bottom:0;">
                                            <option value="1학년">1학년</option>
                                            <option value="2학년">2학년</option>
                                            <option value="3학년">3학년</option>
                                            <option value="4학년">4학년</option>
                                            <option value="5학년" selected>5학년</option>
                                            <option value="6학년">6학년</option>
                                        </select></div>
                                    <div style="flex:1;"><label style="font-size:0.8rem;">평가 대상</label><select
                                            id="autoTargetSelect" style="margin-bottom:0;">
                                            <option value="individual">개인 평가</option>
                                            <option value="group">모둠 평가</option>
                                        </select></div>
                                </div>
                                <button type="button" onclick="generateCriteriaAI(this)"
                                    style="background:linear-gradient(135deg, #9575CD 0%, #7E57C2 100%); width:100%;">🤖
                                    2단계: AI로 기준 자동 생성하기</button>
                            </div>
                            <div id="autoResultInputs">
                                <div style="margin-bottom:12px;"><label
                                        style="font-size:0.85rem; color:var(--color-blue);">① 지식・이해</label><input
                                        type="text" id="autoRate1" placeholder="AI 결과 1" style="margin-bottom:5px;"
                                        readonly disabled><input type="text" id="autoRate2" placeholder="AI 결과 2"
                                        style="margin-bottom:0;" readonly disabled></div>
                                <div style="margin-bottom:12px;"><label
                                        style="font-size:0.85rem; color:var(--color-teal);">② 과정・기능</label><input
                                        type="text" id="autoRate3" placeholder="AI 결과 3" style="margin-bottom:5px;"
                                        readonly disabled><input type="text" id="autoRate4" placeholder="AI 결과 4"
                                        style="margin-bottom:0;" readonly disabled></div>
                                <div style="margin-bottom:12px;"><label
                                        style="font-size:0.85rem; color:var(--color-teacher);">③ 가치・태도</label><input
                                        type="text" id="autoRate5" placeholder="AI 결과 5" style="margin-bottom:5px;"
                                        readonly disabled><input type="text" id="autoRate6" placeholder="AI 결과 6"
                                        style="margin-bottom:0;" readonly disabled></div>
                            </div>
                        </div>
                        <div id="manualCriteriaArea" class="hidden">
                            <div style="margin-bottom:15px;">
                                <div
                                    style="font-weight:700; color:var(--color-blue); font-size:0.9rem; margin-bottom:8px;">
                                    ① 지식・이해</div><input type="text" id="settingRate1" placeholder="기준 1"
                                    style="margin-bottom:8px;"><input type="text" id="settingRate2" placeholder="기준 2"
                                    style="margin-bottom:0;">
                            </div>
                            <div style="margin-bottom:15px;">
                                <div
                                    style="font-weight:700; color:var(--color-teal); font-size:0.9rem; margin-bottom:8px;">
                                    ② 과정・기능</div><input type="text" id="settingRate3" placeholder="기준 1"
                                    style="margin-bottom:8px;"><input type="text" id="settingRate4" placeholder="기준 2"
                                    style="margin-bottom:0;">
                            </div>
                            <div style="margin-bottom:15px;">
                                <div
                                    style="font-weight:700; color:var(--color-teacher); font-size:0.9rem; margin-bottom:8px;">
                                    ③ 가치・태도</div><input type="text" id="settingRate5" placeholder="기준 1"
                                    style="margin-bottom:8px;"><input type="text" id="settingRate6" placeholder="기준 2"
                                    style="margin-bottom:0;">
                            </div>
                        </div>
                        <button onclick="saveDailyCriteria(this)"
                            style="background:var(--color-teal); margin-top:20px;">💾
                            3단계: 평가기준 저장하기</button>
                    </div>
                </div>
                <div id="settingsMiniTab" class="hidden">
                    <div id="teacherManageSubTabArea">
                        <div class="sub-tab-container sub-tab-gap-15 teacher-manage-sub-tab-container">
                            <button type="button" id="teacherManageClassBtn" class="sub-tab-btn active"
                                onclick="switchTeacherManageSubTab('class')">학급관리</button>
                            <button type="button" id="teacherManagePartnerBtn" class="sub-tab-btn"
                                onclick="switchTeacherManageSubTab('partner')">성장 파트너</button>
                        </div>
                    </div>

                    <div id="teacherManageClassTab">
                        <div id="classInfoCard" class="accent-box box-amber class-tone-section">
                            <span class="box-label">📋 우리 학급 정보</span>
                            <div class="settings-two-col" style="display:flex; gap:15px; margin-bottom:15px;">
                                <div class="settings-field" style="flex:1;"><label>학급명</label><input type="text" id="settingClassName" class="class-tone-input"
                                        placeholder="예: 부평서초6-1" style="font-family:'Jua', sans-serif !important;">
                                </div>
                                <div class="settings-field" style="flex:1;"><label>클래스 코드</label><input type="text" id="settingClassCode" class="class-tone-input"
                                        placeholder="예: 부평서초34" style="font-family:'Jua', sans-serif !important;"></div>
                            </div>
                            <button onclick="saveClassInfo(this)" style="background:var(--color-result);">💾 학급 정보
                                저장하기</button>
                            <p style="font-size:0.8rem; color:var(--text-sub); margin-top:10px; text-align:center;">※
                                클래스 코드를 변경하면 학생들도 새로운 코드로 접속해야 합니다. (띄어쓰기 금지)</p>
                        </div>
                        <div id="classCompositionCard" class="accent-box box-violet class-tone-section">
                            <span class="box-label">🏫 우리 반 구성 설정</span>
                            <div id="classCompositionFields" class="settings-two-col" style="display:flex; gap:15px; margin-bottom:15px;">
                                <div class="settings-field" style="flex:1;"><label>👤 학생 수</label><input type="number" id="settingStudentCount" class="class-tone-input"
                                        min="1" max="50" placeholder="30" style="font-family:'Jua', sans-serif !important;">
                                </div>
                                <div class="settings-field" style="flex:1;"><label>👥 모둠 수</label><input type="number" id="settingGroupCount" class="class-tone-input"
                                        min="1" max="20" placeholder="6" style="font-family:'Jua', sans-serif !important;">
                                </div>
                            </div>
                            <button onclick="saveClassSettingsUI(this)" style="background:var(--color-teacher);">💾 반 구성
                                저장하기</button>
                            <p style="font-size:0.8rem; color:var(--text-sub); margin-top:10px; text-align:center;">※
                                학생 수와 모둠 수를 설정합니다.</p>
                        </div>
                        <div id="classSemesterRangeCard" class="accent-box box-slate class-tone-section">
                            <span class="box-label">📅 학기 기준 설정</span>
                            <p style="font-size:0.82rem; color:var(--text-sub); margin-bottom:12px;">
                                여기서 저장한 학기 기간은 스스로배움의 세특생성 1학기/2학기 버튼과 연동됩니다.
                            </p>
                            <div class="settings-two-col" style="display:flex; gap:15px; margin-bottom:12px;">
                                <div class="settings-field" style="flex:1;"><label>1학기 시작일</label><input type="date" id="settingSemester1Start" class="class-tone-input"
                                        style="font-family:'Jua', sans-serif !important;"></div>
                                <div class="settings-field" style="flex:1;"><label>1학기 종료일</label><input type="date" id="settingSemester1End" class="class-tone-input"
                                        style="font-family:'Jua', sans-serif !important;"></div>
                            </div>
                            <div class="settings-two-col" style="display:flex; gap:15px; margin-bottom:15px;">
                                <div class="settings-field" style="flex:1;"><label>2학기 시작일</label><input type="date" id="settingSemester2Start" class="class-tone-input"
                                        style="font-family:'Jua', sans-serif !important;"></div>
                                <div class="settings-field" style="flex:1;"><label>2학기 종료일</label><input type="date" id="settingSemester2End" class="class-tone-input"
                                        style="font-family:'Jua', sans-serif !important;"></div>
                            </div>
                            <button onclick="saveTeacherSemesterSettingsUI(this)" style="background:var(--color-slate);">💾 학기 기준 저장하기</button>
                        </div>
                        <div class="accent-box box-blue class-tone-section">
                            <span class="box-label">👥 학생 번호 매핑 현황</span>
                            <p style="font-size:0.82rem; color:var(--text-sub); margin-bottom:12px;">
                                각 번호에 등록된 Google 계정을 확인하고 모둠을 배정할 수 있습니다.
                            </p>
                            <p id="groupMappingNotice" class="teacher-group-mapping-notice">
                                모둠 변경 시 개인정보 보호를 위해 변경에 연관된 모둠평가 기록(이전+새 모둠)이 초기화됩니다.
                            </p>
                            <div id="studentMappingGrid" class="student-manage-grid"></div>
                            <button type="button" id="saveGroupMappingBtn" onclick="saveStudentGroupMappings(this)" class="teacher-group-mapping-save-btn" disabled>💾 모둠 배정 일괄 저장</button>
                        </div>
                        <div class="accent-box box-red">
                            <span class="box-label" style="color:var(--color-danger);">⚠️ 데이터 초기화</span>
                            <p style="color:var(--color-danger); font-size:0.9rem; margin-bottom:15px;">
                                <strong>주의:</strong>
                                모든 학급 내 데이터가 삭제됩니다.
                            </p>
                            <button id="resetBtn" onclick="resetAllReviewData(this)">학급 데이터 전체 초기화</button>
                        </div>
                    </div>

                    <div id="teacherManagePartnerTab" class="hidden">
                        <div id="teacherPartnerSubTabArea">
                            <div class="sub-tab-container sub-tab-gap-15 teacher-manage-sub-tab-container">
                                <button type="button" id="teacherPartnerReferenceBtn" class="sub-tab-btn active"
                                    onclick="switchTeacherPartnerSubTab('reference')">레퍼런스 자료</button>
                                <button type="button" id="teacherPartnerIndividualBtn" class="sub-tab-btn"
                                    onclick="switchTeacherPartnerSubTab('individual')">개별 확인</button>
                            </div>
                        </div>

                        <div id="teacherPartnerReferenceTab">
                            <div class="accent-box box-amber teacher-partner-reference-card">
                                <span class="box-label">📘 교사용 레퍼런스: 성장 파트너 유형 시스템</span>
                                <div class="teacher-partner-reference-doc">
                                    <div id="teacherPartnerReferenceCards" class="teacher-partner-reference-cards"></div>
                                    <pre id="teacherPartnerReferenceRaw" class="teacher-partner-reference-source hidden">📘 교사용 레퍼런스: 성장 파트너 유형 시스템
📌 Part 1. 질문 구조 (8문항 × 4축)
이 시스템은 학생이 **"어떤 방식으로 피드백을 받고 싶어하는가"**를 파악하기 위한 것입니다. 성격 자체를 분류하는 것이 아니라, 학습 피드백 수용 선호도를 측정합니다.

축	의미	질문	역할
코칭 스타일	피드백의 톤	Q1(★우선), Q2	주 축
정보 처리	피드백의 구조	Q3(★우선), Q4	주 축
실행 전략	실천 제안의 형태	Q5(★우선), Q6	주 축
학습 환경	활동의 종류	Q7(★우선), Q8	보조태그
★ 동률 시 우선 질문(Q1, Q3, Q5, Q7)의 답이 적용됩니다.

📌 Part 2. 각 질문의 의미
축 1: 코칭 스타일 — "이 아이는 직설적 진단을 원하는가, 공감적 동행을 원하는가?"
Q1. "시험 결과가 기대보다 낮았을 때, 선생님이 어떻게 말해주면 좋겠어?"

A: "구체적으로 분석하고 방법을 알려줘" → 해결형
B: "같이 방법을 찾아보자고 말해줘" → 지지형
🔍 교사 해석: 실패 상황에서 학생이 원하는 첫 반응을 봅니다. A를 고른 학생은 감정보다 해결책을 먼저 원하고, B를 고른 학생은 "혼자가 아니다"는 느낌을 먼저 원합니다.

Q2. "모둠 활동에서 내가 맡은 부분의 완성도가 떨어질 때, 어떤 반응이 더 도움이 돼?"

A: "이 부분은 이렇게 고치면 좋을 것 같아." → 해결형
B: "고생많았어. 다음엔 이 부분을 신경 써줘." → 지지형
🔍 교사 해석: 동료/교사의 비판적 피드백을 받는 장면입니다. A 학생은 무엇이 틀렸는지 바로 듣고 싶어하고, B 학생은 노력을 인정받은 후에 개선점을 듣고 싶어합니다. B 학생에게 인정 없이 지적부터 하면 방어적이 될 수 있습니다.

축 2: 정보 처리 — "이 아이는 디테일부터 쌓아가는가, 큰 그림부터 잡는가?"
Q3. "새로운 단원을 배울 때, 어떤 게 더 도움이 돼?"

A: "개념을 읽고 문제 풀이 과정을 쭉 따라가기" → 디테일형
B: "왜 이 단원을 배우는지, 전체 흐름 중 어디인지 먼저 파악" → 큰 그림형
🔍 교사 해석: 학습 진입 방식을 봅니다. A 학생은 구체적 예시와 절차를 따라가며 이해하고, B 학생은 "이걸 왜 배우는지" 맥락이 잡혀야 세부 내용이 들어옵니다. B 학생에게 맥락 없이 문제풀이부터 시키면 동기가 떨어질 수 있습니다.

Q4. "내 결과물에 대한 조언을 받을 때, 어떤 형식이 더 좋아?"

A: "항목별 점수와 구체적 근거" → 디테일형
B: "전체적인 흐름 요약과 다음 방향" → 큰 그림형
🔍 교사 해석: 피드백 수신 형태의 선호입니다. A 학생은 "어디서 몇 점 감점됐고 왜"를 원하고, B 학생은 "전체적으로 이런 느낌이고 다음에 이 방향"을 원합니다. A 학생에게 "전체적으로 괜찮아"라고만 하면 불만족하고, B 학생에게 항목별 점수만 나열하면 압도당할 수 있습니다.

축 3: 실행 전략 — "이 아이는 계획 세우기를 좋아하는가, 일단 해보기를 좋아하는가?"
Q5. "시험 2주 전, 어떤 공부 방식이 나한테 더 맞아?"

A: "과목별 계획표를 짜고 매일 체크" → 계획형
B: "일단 시작하고 그날 상태에 따라 조절" → 탐색형
🔍 교사 해석: 시간 관리 성향을 봅니다. A 학생은 구조와 일정이 있으면 안정감을 느끼고, B 학생은 유연성이 있어야 지속할 수 있습니다. B 학생에게 빡빡한 계획표를 강요하면 오히려 포기가 빨라집니다.

Q6. "방학 동안 뭔가를 배우고 싶을 때, 어떻게 시작해?"

A: "목표와 일정을 먼저 정하고 단계적으로" → 계획형
B: "일단 관심 가는 걸 해보면서 방향을 잡아가기" → 탐색형
🔍 교사 해석: 자기주도 학습의 시작 패턴입니다. A 학생은 로드맵이 있어야 시작하고, B 학생은 호기심이 출발점입니다. 두 유형 모두 가치 있지만, B 학생에게 "먼저 계획을 세워와"라고 하면 시작 자체를 못할 수 있습니다.

축 4 (보조): 학습 환경 — "이 아이는 협력형인가, 독립형인가?"
Q7. "어려운 내용을 이해하고 싶을 때, 어떤 방법을 더 좋아해?"

A: "친구나 선생님한테 물어보면서 정리" → 함께 성장형
B: "혼자 자료를 찾아보며 정리" → 혼자 집중형
🔍 교사 해석: 학습 곤란 상황에서의 대처 방식입니다. A 학생은 대화를 통해 이해를 구성하고, B 학생은 스스로 정리하는 시간이 필요합니다.

Q8. "시험공부 할 때 어떤 환경이 더 집중이 잘 돼?"

A: "친구와 같이 문제 내고 풀기" → 함께 성장형
B: "조용히 혼자 집중해서 풀기" → 혼자 집중형
🔍 교사 해석: 집중 환경 선호입니다. 이 축은 주 유형을 바꾸지 않고 보조태그(#함께 성장형 / #혼자 집중형)로 작동합니다. AI가 실천 활동을 제안할 때 협력 활동(모둠 토론, 짝 설명 등)을 넣을지, 개인 활동(노트 정리, 혼자 풀기 등)을 넣을지 결정합니다.

📌 Part 3. 8가지 유형별 교사 가이드
3개 주 축의 조합으로 8가지 유형이 만들어집니다.

🎯 유형 1: 구체적인 계획가 (해결 × 디테일 × 계획)
이런 아이입니다:

"뭐가 틀렸는지 정확히 알려주세요"가 입버릇인 학생
점수표, 체크리스트, 일정표를 좋아함
모호한 피드백("좀 더 노력해봐")에 불만을 느낌
계획을 세우면 실행력이 높은 편
교사가 이 학생에게 피드백할 때:

✅ "3번 문제 유형에서 실수가 반복되고 있어. 이번 주 월수는 이 유형 5문제씩, 목금은 이 유형으로 연습하자."
❌ "전반적으로 잘하고 있으니까 조금만 더 힘내."
주의할 점:

이 학생은 감정적 위로보다 정보를 원합니다. 틀린 부분을 정확히 짚어주는 것이 존중의 표현이라고 느낍니다.
다만 지적만 나열하면 좌절할 수 있으므로, "잘된 부분 1개 + 개선점 2개 + 실행 계획"의 구조가 효과적입니다.
계획을 세워주면 스스로 실행하는 힘이 있으므로, 중간 점검 정도만 해주면 됩니다.
🛠 유형 2: 구체적인 도전가 (해결 × 디테일 × 탐색)
이런 아이입니다:

뭐가 문제인지는 정확히 알고 싶지만, 정해진 계획표는 싫어하는 학생
"이거 해봐" 하면 바로 시도하는 행동력이 있음
장기 계획보다 "오늘 당장 해볼 것 하나"에 반응함
틀에 박힌 반복 학습은 금방 지루해함
교사가 이 학생에게 피드백할 때:

✅ "이 부분에서 실수가 나왔어. 이 방법으로 딱 3문제만 풀어봐. 맞으면 다음 단계 가자."
❌ "2주 동안 이 계획표대로 매일 해와."
주의할 점:

구체적인 지적은 환영하지만, 장기 로드맵은 부담으로 느낍니다.
작고 명확한 미션 1개를 주고 결과를 같이 확인하는 사이클이 이 학생에게 가장 효과적입니다.
실험 결과를 메모하게 하면 자기 학습 패턴을 스스로 발견하게 됩니다.
🗺 유형 3: 큰 그림형 계획가 (해결 × 큰 그림 × 계획)
이런 아이입니다:

"이거 왜 해요?"를 먼저 묻는 학생
세부 항목보다 전체 방향과 우선순위를 중시함
방향이 잡히면 스스로 계획을 세우는 능력이 있음
의미 없는 반복에는 동기 저하가 빠름
교사가 이 학생에게 피드백할 때:

✅ "전체적으로 보면 이 방향이야. 이번 주는 이것부터, 다음 주는 저것. 이 순서로 하면 시험 범위가 정리될 거야."
❌ "1번은 ○, 2번은 △, 3번은 ×…" (항목별 나열만)
주의할 점:

이 학생에게는 **"왜 이 순서인지"**를 설명해주는 것이 핵심입니다.
우선순위를 함께 정해주면 이후 실행은 스스로 잘합니다.
숲을 보여주고 나무 순서를 잡아주되, 각 나무를 어떻게 심을지는 학생에게 맡기세요.
🚀 유형 4: 큰 그림형 도전가 (해결 × 큰 그림 × 탐색)
이런 아이입니다:

호기심이 많고 다양한 것에 관심을 가지는 학생
정해진 틀보다 "이런 것도 해볼까?"에 눈이 반짝임
방향만 알려주면 자기만의 방식으로 탐색함
너무 구체적인 지시는 오히려 창의성을 막는다고 느낌
교사가 이 학생에게 피드백할 때:

✅ "이런 방향도 있어. 한번 해보고 맞는지 느껴봐. 아니면 이쪽도 재밌을 거야."
❌ "이 순서대로 따라 해. 다른 건 나중에."
주의할 점:

이 학생은 선택지를 주면 동기부여가 됩니다.
"A 방법과 B 방법이 있는데, 뭐가 더 맞을 것 같아?"처럼 옵션을 제시하세요.
산만해 보일 수 있지만, 다양한 시도 속에서 자기 방식을 찾는 타입입니다. 탐색 자체를 인정해주는 것이 중요합니다.
단, "결국 어디로 가고 있는지"를 가끔 환기시켜주면 좋습니다.
📋 유형 5: 함께하는 계획가 (지지 × 디테일 × 계획)
이런 아이입니다:

잘한 점을 먼저 인정받으면 개선점도 기꺼이 받아들이는 학생
단계별 안내가 있으면 안심하고 따라감
피드백의 순서(인정→개선→실행)가 중요
꼼꼼하고 성실하지만, 자신감이 낮을 수 있음
교사가 이 학생에게 피드백할 때:

✅ "이건 진짜 잘했어. 여기는 같이 해보자. 먼저 이것부터, 그 다음에 이것."
❌ "여기 틀렸고, 여기도 부족하고, 이건 다시 해와."
주의할 점:

**"잘한 점 먼저"**가 이 학생에게는 선택이 아니라 필수입니다.
인정 없이 지적부터 시작하면 "나는 못하는 사람"이라는 인식이 강화됩니다.
계획이 있으면 실행을 잘하므로, 1단계→2단계→3단계로 나눠주면 차근차근 따라갑니다.
중간중간 "여기까지 잘하고 있어"라는 확인이 큰 힘이 됩니다.
🤝 유형 6: 함께하는 도전가 (지지 × 디테일 × 탐색)
이런 아이입니다:

따뜻한 분위기에서 "같이 해보자"고 하면 용기를 내는 학생
큰 계획보다 "일단 이것만 해볼까?" 식의 가벼운 시작을 좋아함
실패에 대한 두려움이 있을 수 있어서, 심리적 안전감이 중요
누군가와 함께하면 시도 자체를 더 잘함
교사가 이 학생에게 피드백할 때:

✅ "이건 잘했어! 여기는 이렇게 한번 해볼까? 부담 없이 하나만."
❌ "여기 틀렸으니까 이 10문제 풀어와."
주의할 점:

**"같이"**라는 단어가 이 학생에게는 마법의 단어입니다.
혼자 과제를 안겨주면 시작 자체가 어렵지만, "선생님이랑 같이 한번 보자" 또는 "친구랑 해봐"라고 하면 시도합니다.
작은 성공 경험을 쌓게 해주는 것이 장기적으로 가장 효과적입니다.
실패해도 "시도한 것 자체가 좋았어"라는 메시지가 다음 시도로 이어집니다.
🫶 유형 7: 공감하는 계획가 (지지 × 큰 그림 × 계획)
이런 아이입니다:

기분이나 컨디션에 따라 학습 효율이 크게 달라지는 학생
감정을 먼저 알아줘야 그 다음 내용이 들어옴
방향만 잡아주면 스스로 정리하는 힘이 있음
세부 사항보다 "결국 내가 잘 되고 있는지"가 중요
교사가 이 학생에게 피드백할 때:

✅ "많이 노력했지? 방향은 맞아. 이번 주는 이것만 해보자."
❌ "1번에서 3점 감점, 2번에서 2점 감점…" (감정 터치 없이 숫자만)
주의할 점:

첫 문장이 공감이어야 합니다. "힘들었겠다", "노력한 거 보여", "걱정했구나" 등.
공감 한 문장 + 방향 한 문장 + 이번 주 할 것 하나. 이 3단계가 이 학생의 골든 패턴입니다.
감정을 무시하고 바로 과제를 주면, 할 수 있는 능력이 있어도 하지 않게 됩니다.
"지금 어디쯤 왔는지" 알려주면 안심하고 다음 단계로 넘어갑니다.
🌈 유형 8: 공감하는 도전가 (지지 × 큰 그림 × 탐색)
이런 아이입니다:

감성적이면서도 새로운 것에 열린 학생
강요보다 영감을 통해 움직이는 타입
"이런 것도 해보면 재밌을 거야"라는 한마디에 반응함
정해진 계획보다 자기만의 페이스를 중시함
예술적이거나 창의적인 활동에 잘 반응하는 경우가 많음
교사가 이 학생에게 피드백할 때:

✅ "충분히 잘하고 있어. 이런 것도 해보면 재밌을 거야. 어떻게 생각해?"
❌ "이 계획표대로 해와. 감정은 나중에."
주의할 점:

이 학생에게는 질문이 가장 좋은 피드백 도구입니다.
"이거 해봐"보다 "이런 건 어떨 것 같아?"가 훨씬 효과적입니다.
감정 공감 → 흥미 자극 → 작은 실험 제안의 순서로 접근하세요.
결과보다 과정에서 느낀 것을 물어봐주면 스스로 성찰이 깊어집니다.
가장 자유로운 유형이지만, 방향 없이 표류할 수 있으므로 가끔 "지금 어디쯤인 것 같아?"라고 물어봐주면 좋습니다.
📌 Part 4. 보조태그 활용법
보조태그는 위 8가지 유형에 덧붙여서 실천 활동의 종류를 조절합니다.

보조태그	의미	실천 활동 예시
#함께 성장형	다른 사람과 함께할 때 더 잘 배움	친구와 설명 연습, 모둠 토론, 같이 문제 풀기, 짝 피드백
#혼자 집중형	혼자 집중할 때 더 잘 배움	노트 정리, 혼자 풀어보기, 조용히 복습, 자기만의 요약 만들기
교사 팁:

같은 "구체적인 계획가"라도 #함께 성장형이면 "친구와 계획 공유하고 매일 체크"를, #혼자 집중형이면 "혼자 계획표에 체크하며 진행"을 제안합니다.
보조태그는 강제가 아닌 권장입니다.

상황에 따라 혼자 하는 아이도 모둠 활동이 필요할 수 있고, 함께 하는 아이도 혼자 정리할 시간이 필요합니다.
📌 Part 5. 한눈에 보기
유형	톤	구조	실천	핵심 키워드
🎯 구체적인 계획가	직설 진단	항목별 근거	일정+체크	"정확히, 계획대로"
🛠 구체적인 도전가	직설 진단	항목별 근거	작은 실험	"정확히, 일단 해봐"
🗺 큰 그림형 계획가	방향 제시	흐름 요약	우선순위	"전체 방향, 순서대로"
🚀 큰 그림형 도전가	방향 제시	흐름 요약	선택지	"전체 방향, 골라봐"
📋 함께하는 계획가	인정 후 제안	잘한 점+개선	단계별	"잘했어, 이 순서로"
🤝 함께하는 도전가	인정 후 제안	잘한 점+개선	가벼운 시도	"잘했어, 이것만 해볼까"
🫶 공감하는 계획가	공감 먼저	방향+안심	이번 주 하나	"힘들었지, 이것만"
🌈 공감하는 도전가	공감 먼저	방향+영감	흥미 자극	"잘하고 있어, 이건 어때?"</pre>
                                </div>
                            </div>
                        </div>

                        <div id="teacherPartnerIndividualTab" class="hidden">
                            <div class="accent-box box-blue class-tone-section">
                                <span class="box-label">👥 학생별 성장 파트너 개별 확인</span>
                                <p class="teacher-partner-individual-desc">
                                    우리 반 학생의 성장 파트너 유형과 보조태그를 한눈에 확인하고, 클릭하면 Q1~Q8 응답까지 자세히 볼 수 있습니다.
                                </p>
                                <div id="teacherPartnerSummary" class="teacher-partner-summary-grid"></div>
                                <div class="teacher-partner-individual-grid">
                                    <div id="teacherPartnerList" class="teacher-partner-list"></div>
                                    <div id="teacherPartnerDetail" class="teacher-partner-detail">
                                        <div class="empty-state">
                                            <span class="empty-icon">🧠</span>
                                            <div class="empty-title">학생을 선택해 주세요</div>
                                            <div class="empty-desc">왼쪽 목록에서 학생 번호를 누르면 성장 파트너 상세를 볼 수 있습니다.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="settingMsg" class="message"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="customModal" class="modal-overlay hidden">
        <div class="modal-box">
            <span id="modalIcon" class="modal-icon">🤔</span>
            <div id="modalTitle" class="modal-title">알림</div>
            <div id="modalMessage" class="modal-text"></div>
            <input type="text" id="modalInput" class="hidden"
                style="width:100%; box-sizing:border-box; padding:12px; margin-bottom:20px; border:2px solid var(--border); border-radius:10px; font-size:1rem; outline:none;">
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="modalCancelBtn">취소</button>
                <button class="modal-btn confirm" id="modalConfirmBtn">확인</button>
            </div>
        </div>
    </div>
    <!-- 교과세특 엑셀 다운로드 모달 -->
    <div id="teacherSubjectCommentExportModal" class="modal-overlay hidden">
        <div class="modal-box teacher-subject-comment-export-box">
            <span class="modal-icon">📊</span>
            <div class="modal-title">교과세특(.xlsx) 다운로드</div>
            <div class="modal-text teacher-subject-comment-export-text">
                <div class="teacher-subject-comment-export-grid">
                    <div>
                        <label class="teacher-subject-comment-export-label">학기</label>
                        <select id="teacherSubjectCommentExportSemester" class="class-tone-input teacher-subject-comment-export-input">
                            <option value="all" selected>전체</option>
                            <option value="1">1학기</option>
                            <option value="2">2학기</option>
                        </select>
                    </div>
                    <div>
                        <label class="teacher-subject-comment-export-label">과목</label>
                        <select id="teacherSubjectCommentExportSubject" class="class-tone-input teacher-subject-comment-export-input">
                            <option value="all" selected>전체</option>
                        </select>
                    </div>
                    <div>
                        <label class="teacher-subject-comment-export-label">대상</label>
                        <select id="teacherSubjectCommentExportTarget" class="class-tone-input teacher-subject-comment-export-input">
                            <option value="all" selected>전체 학생</option>
                            <option value="selected">선택 학생</option>
                            <option value="current">현재 학생</option>
                        </select>
                    </div>
                    <div>
                        <label class="teacher-subject-comment-export-label">학교급</label>
                        <select id="teacherSubjectCommentExportSchoolLevel" class="class-tone-input teacher-subject-comment-export-input">
                            <option value="">(설정 사용)</option>
                            <option value="초">초</option>
                            <option value="중">중</option>
                            <option value="고">고</option>
                        </select>
                    </div>
                </div>

                <div id="teacherSubjectCommentExportSelectedArea" class="hidden teacher-subject-comment-export-selected">
                    <div class="teacher-subject-comment-export-selected-title">선택 학생(번호)</div>
                    <div id="teacherSubjectCommentExportStudentGrid" class="teacher-subject-comment-export-student-grid"></div>
                </div>

                <div id="teacherSubjectCommentExportMsg" class="message teacher-subject-comment-export-msg"></div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" type="button" onclick="closeTeacherSubjectCommentExportModal()">취소</button>
                <button class="modal-btn confirm" type="button" onclick="downloadTeacherSubjectCommentXlsx()">다운로드</button>
            </div>
        </div>
    </div>

    <!-- SheetJS (xlsx) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="app.js?v=20260216-personality-type-fix-1"></script>
</body>

</html>


